---
import BaseLayout from '../../layouts/BaseLayout.astro';
import SiteHeader from '../../components/SiteHeader.astro';
import PostCard from '../../components/PostCard.astro';
import { CATEGORIES, type CategorySlug } from '../../lib/categories';
import { getPostsByCategory } from '../../lib/posts';

export function getStaticPaths() {
  return CATEGORIES.map((category) => ({
    params: { category: category.slug },
    props: { category },
  }));
}

const { category } = Astro.props;
const slug = Astro.params.category as CategorySlug;
const filteredPosts = getPostsByCategory(slug);
---

<BaseLayout title={`${category.label} | 복지정보.com`}>
  <SiteHeader />
  <section class="space-y-2 pb-4">
    <h1 class="text-2xl font-bold text-slate-900 sm:text-3xl">{category.label}</h1>
    <p class="text-sm text-slate-600">카테고리 관련 최신 글 {filteredPosts.length}건</p>
  </section>

  {
    filteredPosts.length > 0 ? (
      <section class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3">
        {filteredPosts.map((post) => <PostCard post={post} />)}
      </section>
    ) : (
      <p class="rounded-xl border border-dashed border-slate-300 bg-white p-6 text-slate-500">
        아직 등록된 글이 없습니다.
      </p>
    )
  }
</BaseLayout>
